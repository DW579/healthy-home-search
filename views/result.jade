extends layout

block content

  section.main
    header
      .row
        nav.top-bar(data-topbar='', role='navigation')
          ul.title-area
            li.name

            span.toggle-topbar.menu-icon
              a(href='#')
                span Menu


          section#mean_nav.top-bar-section
            ul.right
              li
                a(href='#scores') Healthy Scores
              li
                a(href='#community') Community
              li
                a(href='#accessibility') Accessibility
              li
                a(href='#environment') Environment
              li
                a(href='#safety') Safety
    section.caption
      .row
        h1.mean_cap
          | Let us Help You to Find Your Next
          h2.sub_cap Healthy Living
          a.score_arrow.btn_details(href='#scores')
            span See Your Healthy Home Scores
            img.arrow(src='images/btn_arrow.png', alt='')

  section#scores.scores
    .row
      h1.mean_title Here are your Scores Below
      h2.sub_title Your Home is Our Priority
    // End scores Titles
    // Start scores List
    .row.scores_list
      .small-12.medium-3.large-3.columns


        img.serv_icon(src='images/icon2.png', alt='', title='')
        h1.mean_title 92
        .btn_holder
          a.btn_fancy(href='#community')
            .solid_layer
            .border_layer
            .text_layer Community
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.

      .small-12.medium-3.large-3.columns
        img.serv_icon(src='images/icon1.png', alt='', title='')
        h1.mean_title 76
        .btn_holder
          a.btn_fancy(href='#accessibility')
            .solid_layer
            .border_layer
            .text_layer Accessibility
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.

      .small-12.medium-3.large-3.columns
        img.serv_icon(src='images/icon3.png', alt='', title='')
        h1.mean_title 65
        .btn_holder
          a.btn_fancy(href='#safety')
            .solid_layer
            .border_layer
            .text_layer Safety
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.

      .small-12.medium-3.large-3.columns
        img.serv_icon(src='images/icon4.png', alt='', title='')
        h1.mean_title 97
        .btn_holder
          a.btn_fancy(href='#environment')
            .solid_layer
            .border_layer
            .text_layer Environment
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.

  section#community.community
    .expanded
      .large-7.columns
        #community_map
        nav.menu-ui
          a.active(href='#', data-filter='all') Show all
          a(href='#', data-filter='schools') Schools
          a(href='#', data-filter='parks') Parks
          a(href='#', data-filter='restaurants') Restaurants
          a(href='#', data-filter='viewpoints') Viewpoints
          a(href='#', data-filter='cultural-spaces') Cultural Spaces

      .large-5.columns
        .community_sub
          h2.sub_cap Community Score

  section#accessibility.accessibility
    .expanded
      .large-7.columns
        #accessibility_map
        nav.menu-ui
          a.active(href='#', data-filter='all') Show all
          a(href='#', data-filter='bus-stop') Bus Stops
          a(href='#', data-filter='parking') Parkings
      .large-5.columns
        .accessibility_sub
          h2.sub_cap_sec Accessibility Score

          h3 #{allData.renderWalkScore.walkscore}
          p #{allData.renderWalkScore.description}

  section#environment.environment
    .expanded
      .large-7.columns
        #environment_map
        nav.menu-ui
          a.active(href='#', data-filter='all') Show all
          a(href='#', data-filter='single-family') Single Family
          a(href='#', data-filter='multifamily') Multifamily
          a(href='#', data-filter='commercial') Commercial
          a(href='#', data-filter='institutional') Institutional
          a(href='#', data-filter='indulstrial') Indulstrial
      .large-5.columns
        .environment_sub
          h2.sub_cap Environment Score

          h3 #{allData.renderAqi.breezometer_aqi}
          p #{allData.renderAqi.breezometer_description}

  section#safety.safety
    .expanded
      .large-7.columns

        .crime_graph

      .large-5.columns
        .safety_sub
          h2.sub_cap_sec Safety Score
          p Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

  .shadow


  footer
  a#back_top.btn_fancy(href='#')
    .solid_layer
    .border_layer
    .text_layer
      img.top_arrow(src='images/top_arrow.png', alt='Back to top', title='')

  script.
    L.mapbox.accessToken = 'pk.eyJ1IjoiaGVucnliaSIsImEiOiJjaW42NmVvMmowZTFidXBra2xkM2N3cTE1In0.cdfJiLolXJoUefefWOKqew';

    var allData = !{JSON.stringify(allData)};
    console.log(allData);

    var communityMap = new L.mapbox.map('community_map', 'mapbox.streets').setView([#{allData.renderLocation.long}, #{allData.renderLocation.lat}], 15);

    L.mapbox.styleLayer('mapbox://styles/henrybi/cin8j804n0090bckv5dtpjoe3').addTo(communityMap);

    L.mapbox.featureLayer({
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [
          #{allData.renderLocation.lat},
          #{allData.renderLocation.long}
        ]
      },
      properties: {
        title: 'My featured house',
        description: 'Healthy Search',
        'marker-size': 'large',
        'marker-color': '#5dfd92',
        'marker-symbol': 'star',
        }
    }).addTo(communityMap);

    var communityGeoJson = [];

    for (var i = 0; i < allData.renderSchool.length; i++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderSchool[i].long_cen,
            allData.renderSchool[i].lat_cen
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderSchool[i].name,
          "schools": true,
          "parks": false,
          "restaurants": false,
          "viewpoints": false,
          "cultural-spaces": false,
          "marker-color": "#2f36b6",
          "marker-size": "medium",
        }
      });
    }

    for (var j = 0; j < allData.renderParks.length; j++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderParks[j].longitude,
            allData.renderParks[j].latitude
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderParks[j].common_name,
          "schools": false,
          "parks": true,
          "restaurants": false,
          "viewpoints": false,
          "cultural-spaces": false,
          "marker-color": "#3ebc36",
          "marker-size": "medium",
        }
      });
    }



    for (var r = 1; r <= 9; r++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderRestaurants.nearby_restaurants[r].restaurant.location.longitude, allData.renderRestaurants.nearby_restaurants[r].restaurant.location.latitude
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderRestaurants.nearby_restaurants[r].restaurant.name,
          "schools": false,
          "parks": false,
          "restaurants": true,
          "viewpoints": false,
          "cultural-spaces": true,
          "marker-color": "#7bd0b5",
          "marker-size": "medium",
        }
      });
    }
