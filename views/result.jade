extends layout

block content

  section.main
    header
      .row
        nav.top-bar(data-topbar='', role='navigation')
          // Start Logo
          ul.title-area
            li.name

            span.toggle-topbar.menu-icon
              a(href='#')
                span Menu


          // Start Navigation Menu
          section#mean_nav.top-bar-section
            ul.right
              li
                a(href='#scores') Healthy Scores
              li
                a(href='#community') Community
              li
                a(href='#accessibility') Accessibility
              li
                a(href='#safety') Safety
              li
                a(href='#environment') Environment
          // End Navigation Menu
    // Start Hero Caption
    section.caption
      .row
        h1.mean_cap
          | Let us Help You to Find Your Next
          h2.sub_cap Healthy Living
          a.score_arrow.btn_details(href='#scores')
            span See Your Healthy Home Scores
            img.arrow(src='images/btn_arrow.png', alt='')
    // End Hero Caption
  // End Hero Section
  // Start scores Section
  section#scores.scores
    // Start scores Titles
    .row
      h1.mean_title Here are your Scores Below
      h2.sub_title Your Home is Our Priority
    // End scores Titles
    // Start scores List
    .row.scores_list
      .small-12.medium-3.large-3.columns
      
      
        img.serv_icon(src='images/icon2.png', alt='', title='')
        h1.mean_title 92
        .btn_holder
          a.btn_fancy(href='#community')
            .solid_layer
            .border_layer
            .text_layer Community
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
      .small-12.medium-3.large-3.columns
      
      
        img.serv_icon(src='images/icon1.png', alt='', title='')
        h1.mean_title 76
        .btn_holder
          a.btn_fancy(href='#accessibility')
            .solid_layer
            .border_layer
            .text_layer Accessibility
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
      .small-12.medium-3.large-3.columns
      
      
        img.serv_icon(src='images/icon3.png', alt='', title='')
        h1.mean_title 65
        .btn_holder
          a.btn_fancy(href='#safety')
            .solid_layer
            .border_layer
            .text_layer Safety
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
      .small-12.medium-3.large-3.columns
      
      
        img.serv_icon(src='images/icon4.png', alt='', title='')
        h1.mean_title 97
        .btn_holder
          a.btn_fancy(href='#environment')
            .solid_layer
            .border_layer
            .text_layer Environment
        br
        p
          | Ruis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
          
  section.break    
  
  section#community.community
    .row
      .large-7.columns
        #community_map
        nav.menu-ui
          a.active(href='#', data-filter='all') Show all
          a(href='#', data-filter='schools') Schools
          a(href='#', data-filter='parks') Parks
          a(href='#', data-filter='viewpoints') Viewpoints
          a(href='#', data-filter='cultural-spaces') Cultural Spaces

      .large-5.columns
        p Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      
  section.break    
      
  section#accessibility.accessibility
    .row
      .large-5.columns
        p Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      .large-7.columns
        #accessibility_map
        
  section.break    
        
  section#safety.safety
    .row
      .large-7.columns
        img(src='https://placeimg.com/640/480/any')
      .large-5.columns
        p Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
          
  section.break    
      
  section#environment.environment
    .row
      .large-5.columns
        p Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
      .large-7.columns
        #environment_map
        nav.menu-ui
          a.active(href='#', data-filter='all') Show all
          a(href='#', data-filter='single-family') Single Family
          a(href='#', data-filter='multifamily') Multifamily
          a(href='#', data-filter='commercial') Commercial
          a(href='#', data-filter='institutional') Institutional
          a(href='#', data-filter='indulstrial') Indulstrial
        
  .shadow


  footer
  a#back_top.btn_fancy(href='#')
    .solid_layer
    .border_layer
    .text_layer
      img.top_arrow(src='images/top_arrow.png', alt='Back to top', title='')
  
  script.
    L.mapbox.accessToken = 'pk.eyJ1IjoiaGVucnliaSIsImEiOiJjaW42NmVvMmowZTFidXBra2xkM2N3cTE1In0.cdfJiLolXJoUefefWOKqew';
    
    var allData = !{JSON.stringify(allData)};
    console.log(allData);
    
    var communityMap = new L.mapbox.map('community_map', 'mapbox.streets').setView([#{allData.renderLocation.long}, #{allData.renderLocation.lat}], 15);

    L.mapbox.featureLayer({
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [
          #{allData.renderLocation.lat},
          #{allData.renderLocation.long} 
        ]
      },
      properties: {
        title: 'My featured house',
        description: 'Healthy Search',
        'marker-size': 'large',
        'marker-color': '#5dfd92',
        'marker-symbol': 'star',
        }
    }).addTo(communityMap);
    
    var communityGeoJson = [];
    
    for (var i = 0; i < allData.renderSchool.length; i++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderSchool[i].long_cen,
            allData.renderSchool[i].lat_cen
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderSchool[i].name,
          "schools": true,
          "parks": false,
          "viewpoints": false,
          "cultural-spaces": false,
          "marker-color": "#2f36b6",
          "marker-size": "large",
        }
      });  
    }
      
    for (var j = 0; j < allData.renderParks.length; j++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderParks[j].longitude,
            allData.renderParks[j].latitude
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderParks[j].common_name,
          "schools": false,
          "parks": true,
          "viewpoints": false,
          "cultural-spaces": false,
          "marker-color": "#3ebc36",
          "marker-size": "large",
        }
      });  
    }
    
    for (var k = 0; k < allData.renderViewpoints.length; k++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderViewpoints[k].longitude,
            allData.renderViewpoints[k].latitude
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderViewpoints[k].common_name,
          "schools": false,
          "parks": false,
          "viewpoints": true,
          "cultural-spaces": false,
          "marker-color": "#da6339",
          "marker-size": "large",
        }
      });  
    }
    
    for (var l = 0; l < allData.renderCultCenters.length; l++) {
      communityGeoJson.push({
        "type": "Feature",
        "geometry": {
          "coordinates": [
            allData.renderCultCenters[l].location.coordinates[0],
            allData.renderCultCenters[l].location.coordinates[1]
          ],
          "type": "Point"
        },
        "properties": {
          "title": allData.renderCultCenters[l].name,
          "schools": false,
          "parks": false,
          "viewpoints": false,
          "cultural-spaces": true,
          "marker-color": "#b64990",
          "marker-size": "large",
        }
      });  
    }
      
    var communityMarkers = L.mapbox.featureLayer().setGeoJSON(communityGeoJson).addTo(communityMap);
    
    $('.menu-ui a').on('click', function() {
      var filter = $(this).data('filter');
      $(this).addClass('active').siblings().removeClass('active');
      communityMarkers.setFilter(function(f) {
        return (filter === 'all') ? true : f.properties[filter] === true;
      });
      return false;
    });
        
    
    var accessibilityMap = new L.mapbox.map('accessibility_map', 'mapbox.streets').setView([#{allData.renderLocation.long}, #{allData.renderLocation.lat}], 15);

    L.mapbox.featureLayer({
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [
          #{allData.renderLocation.lat},
          #{allData.renderLocation.long} 
        ]
      },
      properties: {
        title: 'My featured house',
        description: 'Healthy Search',
        'marker-size': 'large',
        'marker-color': '#5dfd92',
        'marker-symbol': 'star',
        }
    }).addTo(accessibilityMap);
        
    var environmentMap = new L.mapbox.map('environment_map', 'mapbox.streets').setView([#{allData.renderLocation.long}, #{allData.renderLocation.lat}], 16);
    
    L.mapbox.featureLayer({
      type: 'Feature',
      geometry: {
        type: 'Point',
        coordinates: [
          #{allData.renderLocation.lat},
          #{allData.renderLocation.long} 
        ]
      },
      properties: {
        title: 'My featured house',
        description: 'Healthy Search',
        'marker-size': 'large',
        'marker-color': '#5dfd92',
        'marker-symbol': 'star',
        }
    }).addTo(environmentMap);
    
    var environmentGeoJson = [];
    
    for (var o = 0; o < allData.renderPermits.length; o++) {
      if(allData.renderPermits[o].category === 'SINGLE FAMILY / DUPLEX'){
        environmentGeoJson.push({
          "type": "Feature",
          "geometry": {
            "coordinates": [
              allData.renderPermits[o].longitude,
              allData.renderPermits[o].latitude
            ],
            "type": "Point"
          },
          "properties": {
            "title": allData.renderPermits[o].permit_type,
            "description": 'Status: ' + allData.renderPermits[o].status,
            "single-family": true,
            "multifamily": false,
            "commercial": false,
            "indulstrial": false,
            "institutional": false,
            "marker-color": "#da2e00",
            "marker-size": "large",
          }
        });  
      } else if (allData.renderPermits[o].category === 'MULTIFAMILY'){
        environmentGeoJson.push({
          "type": "Feature",
          "geometry": {
            "coordinates": [
              allData.renderPermits[o].longitude,
              allData.renderPermits[o].latitude
            ],
            "type": "Point"
          },
          "properties": {
            "title": allData.renderPermits[o].permit_type,
            "description": 'Status: ' + allData.renderPermits[o].status,
            "single-family": false,
            "multifamily": true,
            "commercial": false,
            "indulstrial": false,
            "institutional": false,
            "marker-color": "#00dab6",
            "marker-size": "large",
          }
        });  
      } else if (allData.renderPermits[o].category === 'COMMERCIAL'){
        environmentGeoJson.push({
          "type": "Feature",
          "geometry": {
            "coordinates": [
              allData.renderPermits[o].longitude,
              allData.renderPermits[o].latitude
            ],
            "type": "Point"
          },
          "properties": {
            "title": allData.renderPermits[o].permit_type,
            "description": 'Status: ' + allData.renderPermits[o].status,
            "single-family": false,
            "multifamily": false,
            "commercial": true,
            "indulstrial": false,
            "institutional": false,
            "marker-color": "#008ada",
            "marker-size": "large",
          }
        });  
      } else if (allData.renderPermits[o].category === 'INSTITUTIONAL'){
        environmentGeoJson.push({
          "type": "Feature",
          "geometry": {
            "coordinates": [
              allData.renderPermits[o].longitude,
              allData.renderPermits[o].latitude
            ],
            "type": "Point"
          },
          "properties": {
            "title": allData.renderPermits[o].permit_type,
            "description": 'Status: ' + allData.renderPermits[o].status,
            "single-family": false,
            "multifamily": false,
            "commercial": false,
            "indulstrial": false,
            "institutional": true,
            "marker-color": "#007123",
            "marker-size": "large",
          }
        }); 
      } else if (allData.renderPermits[o].category === 'INDULSTRIAL'){
        environmentGeoJson.push({
          "type": "Feature",
          "geometry": {
            "coordinates": [
              allData.renderPermits[o].longitude,
              allData.renderPermits[o].latitude
            ],
            "type": "Point"
          },
          "properties": {
            "title": allData.renderPermits[o].permit_type,
            "description": 'Status: ' + allData.renderPermits[o].status,
            "single-family": false,
            "multifamily": false,
            "commercial": false,
            "indulstrial": false,
            "institutional": true,
            "marker-color": "#001071",
            "marker-size": "large",
          }
        }); 
      }
    }
    
    var environmentMarkers = L.mapbox.featureLayer().setGeoJSON(environmentGeoJson).addTo(environmentMap);
    
    $('.menu-ui a').on('click', function() {
      var filter = $(this).data('filter');
      $(this).addClass('active').siblings().removeClass('active');
      environmentMarkers.setFilter(function(f) {
        return (filter === 'all') ? true : f.properties[filter] === true;
      });
      return false;
    });
    
